<% if @business_partner.nil? %>
  <script type=text/javascript>
    alert('次の取引先データがありません。\n入力支援機能を終了します。');
    window.close()
  </script>
<% else %>
  <div class="container-fluid">
  <div class="row-fluid">
    <div class="span12">
      <%= content_tag :h3, @business_partner.business_partner_name %>
      <button class="btn btn-success" type="button" onclick='getNextBP(<%= @business_partner.id %>, <%= params[:page] %>)'>次の企業</button><button class="btn btn-danger" type="button" onclick='disp()'>入力終了</button>
    </div>
  </div>
  <div class="row-fluid">
    <div class="span12">
      <%= form_tag({controller: 'business_partner', action: 'update_quick_input'}, class: "form-inline") do %>
      <!-- <form class="form-inline"> -->
        <fieldset>
          <legend>企業情報入力</legend>
          <%= hidden_field 'business_partner', 'id' %>
          <p><label><%=getLongName('business_partners','establishment_year') + ': '%></label>
          <%= text_field 'business_partner', 'establishment_year' %>/p>
          <label><%=getLongName('business_partners','employee_number') + ': '%></label>
          <%= text_field 'business_partner', 'employee_number' %>
          <label><%=getLongName('business_partners','share_capital') + ': '%></label>
          <%= text_field 'business_partner', 'share_capital' %>
          <label><%=getLongName('business_partners','email') + ': '%></label>
          <%= text_field 'business_partner', 'email' %>
          <%= hidden_field_tag 'back_to', request_url %>
          <%= submit_tag '更新', confirm: @business_partner.business_partner_name + 'の情報を更新します。よろしいですか？' %>
        </fieldset>
        <%end%>
      <!-- </form> -->
    </div>
  </div>
  <div class="row-fluid">
    <div class="span12">
      <% if @business_partner.url.blank? %>
          <!-- <script type="text/javascript">alert('取引先URLが入力されていません。')</script> -->
      <% end %>
      <iframe id='iframe_bp' src="<%= @business_partner.url %>" width=100% %>このブラウザは対応していません。</iframe>
    </div>
  </div>
  </div>

  <script type="text/javascript">
    function heightResize() {
      // var iframeHeight = document.body.scrollHeight;
      // var mainBoxHeight = document.getElementById('contents_box').offsetHeight;
      var mainBoxHeight = window.innerHeight;
      var titleHeight = document.getElementById('title').offsetHeight;

      // 画面内に収まるようiframeの高さを調節
      window.parent.document.getElementById('iframe_bp').style.height = (mainBoxHeight - titleHeight) + 'px';
    }
    window.onload = heightResize;

    function getNextBP(id, page, url) {
      // 新しい取引先を取得して再描画
      location.href = 'next_bp?callback=setBpPic&popup=1&page=' + page + '&business_partner_id=' + id
    }

    function disp() {
      if(window.confirm('入力支援機能を終了します。\nよろしいですか？')) {
        window.close()
      }
    }
  </script>
<% end %>